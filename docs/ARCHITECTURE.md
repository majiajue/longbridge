# Longbridge é‡åŒ–äº¤æ˜“ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¦‚è§ˆ](#ç³»ç»Ÿæ¦‚è§ˆ)
- [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [åç«¯æ¶æ„](#åç«¯æ¶æ„)
- [å‰ç«¯æ¶æ„](#å‰ç«¯æ¶æ„)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#æ ¸å¿ƒç»„ä»¶è¯¦è§£)
- [æ–‡ä»¶ä¸ç›®å½•è¯¦è§£](#æ–‡ä»¶ä¸ç›®å½•è¯¦è§£)

---

## ç³»ç»Ÿæ¦‚è§ˆ

### é¡¹ç›®ç®€ä»‹

æœ¬ç³»ç»Ÿæ˜¯åŸºäº **Longbridge OpenAPI** çš„æœ¬åœ°é‡åŒ–äº¤æ˜“å¹³å°ï¼Œæ”¯æŒï¼š
- å®æ—¶è¡Œæƒ…è®¢é˜…ä¸å±•ç¤º
- å†å² K çº¿æ•°æ®åŒæ­¥ä¸æŸ¥è¯¢
- è‡ªåŠ¨äº¤æ˜“ç­–ç•¥å¼•æ“
- ä»“ä½å®æ—¶ç›‘æ§ä¸é£é™©ç®¡ç†
- å¤šç­–ç•¥å¹¶è¡Œæ‰§è¡Œ
- å®æ—¶é€šçŸ¥ç³»ç»Ÿ

### æŠ€æœ¯æ ˆ

**åç«¯**ï¼š
- Python 3.9+
- FastAPIï¼ˆWeb æ¡†æ¶ï¼‰
- DuckDBï¼ˆæœ¬åœ°æ•°æ®åº“ï¼‰
- Longbridge Python SDKï¼ˆè¡Œæƒ…ä¸äº¤æ˜“ APIï¼‰
- asyncioï¼ˆå¼‚æ­¥ç¼–ç¨‹ï¼‰

**å‰ç«¯**ï¼š
- React 18
- TypeScript
- Viteï¼ˆæ„å»ºå·¥å…·ï¼‰
- Tailwind CSSï¼ˆæ ·å¼ï¼‰
- WebSocketï¼ˆå®æ—¶é€šä¿¡ï¼‰

**æ•°æ®å­˜å‚¨**ï¼š
- DuckDBï¼ˆåµŒå…¥å¼æ•°æ®åº“ï¼‰
- Fernet åŠ å¯†ï¼ˆå‡­æ®å­˜å‚¨ï¼‰

---

## æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯å±‚ (React)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è®¾ç½®é¡µé¢ â”‚ å®æ—¶è¡Œæƒ… â”‚ Kçº¿å›¾è¡¨  â”‚ ç­–ç•¥æ§åˆ¶ â”‚ ä»“ä½ç›‘æ§é¡µé¢  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                   â”‚
â”‚                      API Client (client.ts)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ HTTP / WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       API å±‚ (FastAPI)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ settings â”‚  quotes  â”‚portfolio â”‚strategiesâ”‚ notifications â”‚  â”‚
â”‚  â”‚  router  â”‚  router  â”‚  router  â”‚  router  â”‚    router     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¸šåŠ¡é€»è¾‘å±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Services   â”‚RepositoriesRepositories â”‚  Models      â”‚   â”‚
â”‚  â”‚ (ä¸šåŠ¡é€»è¾‘)    â”‚ (æ•°æ®è®¿é—®)    â”‚  (æ•°æ®æ¨¡å‹)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ ¸å¿ƒå¼•æ“å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ QuoteStream    â”‚ StrategyEngine â”‚ PositionMonitor      â”‚   â”‚
â”‚  â”‚ Manager        â”‚ (ç­–ç•¥å¼•æ“)      â”‚ (ä»“ä½ç›‘æ§)            â”‚   â”‚
â”‚  â”‚ (è¡Œæƒ…æµç®¡ç†)    â”‚                â”‚                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ TradingAPI     â”‚ Notification   â”‚ OptimalTrading       â”‚   â”‚
â”‚  â”‚ (äº¤æ˜“æ¥å£)      â”‚ Manager        â”‚ Signals              â”‚   â”‚
â”‚  â”‚                â”‚ (é€šçŸ¥ç®¡ç†)      â”‚ (ä¿¡å·åˆ†æ)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤–éƒ¨æœåŠ¡ & æ•°æ®å­˜å‚¨                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Longbridge     â”‚ Longbridge     â”‚      DuckDB          â”‚   â”‚
â”‚  â”‚ QuoteContext   â”‚ TradeContext   â”‚   (æœ¬åœ°æ•°æ®åº“)        â”‚   â”‚
â”‚  â”‚ (è¡Œæƒ… API)      â”‚ (äº¤æ˜“ API)      â”‚                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é¡¹ç›®ç»“æ„

```
longbridge/
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app/                    # åº”ç”¨ä¸»ç›®å½•
â”‚   â”‚   â”œâ”€â”€ routers/           # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py        # åŒ…åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ db.py              # æ•°æ®åº“è¿æ¥ä¸è¿ç§»
â”‚   â”‚   â”œâ”€â”€ exceptions.py      # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”‚   â”œâ”€â”€ main.py            # FastAPI åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ models.py          # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services.py        # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ repositories.py    # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ streaming.py       # è¡Œæƒ…æµç®¡ç†
â”‚   â”‚   â”œâ”€â”€ strategy_engine.py # ç­–ç•¥å¼•æ“
â”‚   â”‚   â”œâ”€â”€ position_monitor.py# ä»“ä½ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ trading_api.py     # äº¤æ˜“ API å°è£…
â”‚   â”‚   â”œâ”€â”€ notification_manager.py # é€šçŸ¥ç®¡ç†
â”‚   â”‚   â””â”€â”€ optimal_trading_signals.py # æœ€ä¼˜ä¿¡å·åˆ†æ
â”‚   â”œâ”€â”€ data/                  # è¿è¡Œæ—¶æ•°æ®
â”‚   â”‚   â”œâ”€â”€ quant.db           # DuckDB æ•°æ®åº“æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ quant.db.wal       # é¢„å†™æ—¥å¿—
â”‚   â””â”€â”€ pyproject.toml         # Python é¡¹ç›®é…ç½®
â”‚
â”œâ”€â”€ frontend/                  # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/              # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ components/       # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ App.tsx           # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ main.tsx          # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ index.css         # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ dist/                 # æ„å»ºäº§ç‰©
â”‚   â”œâ”€â”€ package.json          # Node.js ä¾èµ–
â”‚   â”œâ”€â”€ vite.config.ts        # Vite é…ç½®
â”‚   â””â”€â”€ tsconfig.json         # TypeScript é…ç½®
â”‚
â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ strategies.json       # ç­–ç•¥é…ç½®
â”‚
â”œâ”€â”€ data/                     # å…±äº«æ•°æ®ç›®å½•
â”‚   â””â”€â”€ quant.db             # DuckDB æ•°æ®åº“ï¼ˆç¬¦å·é“¾æ¥ï¼‰
â”‚
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ backend.log          # åç«¯æ—¥å¿—
â”‚   â””â”€â”€ frontend.log         # å‰ç«¯æ—¥å¿—
â”‚
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”‚   â”œâ”€â”€ ARCHITECTURE.md      # æ¶æ„æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ DECISIONS.md         # æ¶æ„å†³ç­–è®°å½•
â”‚   â”œâ”€â”€ README.md            # æ–‡æ¡£è¯´æ˜
â”‚   â”œâ”€â”€ rules.md             # ç¼–ç è§„èŒƒ
â”‚   â””â”€â”€ llms.txt             # LLM æç¤ºè¯
â”‚
â”œâ”€â”€ .cursor/                 # Cursor IDE é…ç½®
â”‚   â””â”€â”€ rules/              # Cursor Rules
â”‚       â”œâ”€â”€ backend-fastapi.mdc
â”‚       â”œâ”€â”€ db-duckdb.mdc
â”‚       â”œâ”€â”€ frontend-react.mdc
â”‚       â”œâ”€â”€ notifications.mdc
â”‚       â”œâ”€â”€ strategy-engine.mdc
â”‚       â”œâ”€â”€ trading-api.mdc
â”‚       â”œâ”€â”€ position-monitor.mdc
â”‚       â”œâ”€â”€ error-handling.mdc
â”‚       â”œâ”€â”€ repositories.mdc
â”‚       â””â”€â”€ ... (å…¶ä»–è§„åˆ™æ–‡ä»¶)
â”‚
â”œâ”€â”€ scripts/                 # è„šæœ¬å·¥å…·
â”‚   â””â”€â”€ update_llms.sh      # æ›´æ–° LLM æç¤ºè¯è„šæœ¬
â”‚
â”œâ”€â”€ start.sh / start.bat    # å¯åŠ¨è„šæœ¬ï¼ˆLinux/Windowsï¼‰
â”œâ”€â”€ stop.sh / stop.bat      # åœæ­¢è„šæœ¬
â”œâ”€â”€ start_trading.py        # äº¤æ˜“å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

---

## åç«¯æ¶æ„

### å±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer              â”‚
â”‚  (FastAPI Routers - HTTP/WebSocket)     â”‚
â”‚  - settings.py, quotes.py, etc.         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Business Logic Layer            â”‚
â”‚  - services.py (ä¸šåŠ¡é€»è¾‘)                â”‚
â”‚  - models.py (æ•°æ®æ¨¡å‹)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Data Access Layer               â”‚
â”‚  - repositories.py (æ•°æ®è®¿é—®)            â”‚
â”‚  - db.py (æ•°æ®åº“è¿æ¥)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Engine & Manager Layer          â”‚
â”‚  - streaming.py (è¡Œæƒ…æµ)                 â”‚
â”‚  - strategy_engine.py (ç­–ç•¥)             â”‚
â”‚  - position_monitor.py (ç›‘æ§)            â”‚
â”‚  - notification_manager.py (é€šçŸ¥)        â”‚
â”‚  - trading_api.py (äº¤æ˜“)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         External Services               â”‚
â”‚  - Longbridge SDK                       â”‚
â”‚  - DuckDB                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯åŠ¨æµç¨‹

1. **main.py** åˆå§‹åŒ– FastAPI åº”ç”¨
2. æ³¨å†Œä¸­é—´ä»¶ï¼ˆCORSã€æ—¥å¿—ï¼‰
3. æ³¨å†Œæ‰€æœ‰è·¯ç”±å™¨ï¼ˆroutersï¼‰
4. **startup äº‹ä»¶**ï¼š
   - ç¡®ä¿æ•°æ®ç›®å½•å­˜åœ¨
   - åˆå§‹åŒ–æ•°æ®åº“è¿æ¥
   - å¯åŠ¨è¡Œæƒ…æµç®¡ç†å™¨ï¼ˆQuoteStreamManagerï¼‰
   - å¯åŠ¨ä»“ä½ç›‘æ§ï¼ˆPositionMonitorï¼‰
5. **shutdown äº‹ä»¶**ï¼š
   - åœæ­¢è¡Œæƒ…æµ
   - åœæ­¢ä»“ä½ç›‘æ§
   - å…³é—­æ•°æ®åº“è¿æ¥

---

## å‰ç«¯æ¶æ„

### ç»„ä»¶å±‚æ¬¡

```
App.tsx (æ ¹ç»„ä»¶)
  â”œâ”€â”€ Tab Navigation (é¡¶éƒ¨å¯¼èˆª)
  â”œâ”€â”€ Settings (è®¾ç½®é¡µé¢)
  â”œâ”€â”€ RealtimeSimple (å®æ—¶è¡Œæƒ…)
  â”œâ”€â”€ RealtimeKLine (å®æ—¶ K çº¿)
  â”œâ”€â”€ History (å†å²æ•°æ®)
  â”œâ”€â”€ StrategyControl (ç­–ç•¥æ§åˆ¶)
  â”œâ”€â”€ PositionMonitoring (ä»“ä½ç›‘æ§)
  â””â”€â”€ SignalAnalysis (ä¿¡å·åˆ†æ)

API Layer
  â”œâ”€â”€ client.ts (API åŸºç¡€å®¢æˆ·ç«¯)
  â””â”€â”€ quotes.ts (è¡Œæƒ…ä¸“ç”¨ API)

Components (å¯å¤ç”¨ç»„ä»¶)
  â”œâ”€â”€ KLineChart.tsx
  â”œâ”€â”€ StatusSnackbar.tsx
  â””â”€â”€ LoadingSpinner.tsx
```

### æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ é¡µé¢ç»„ä»¶ â†’ API Client â†’ åç«¯ API
                        â†“
            WebSocket â† å®æ—¶æ•°æ®æ¨é€
                        â†“
            ç»„ä»¶çŠ¶æ€æ›´æ–° â†’ UI é‡æ–°æ¸²æŸ“
```

---

## æ•°æ®æµ

### è¡Œæƒ…æ•°æ®æµ

```
Longbridge QuoteContext
    â†“ (å®æ—¶æ¨é€)
QuoteStreamManager._on_quote()
    â†“ (å½’ä¸€åŒ–)
1. WebSocket å®¢æˆ·ç«¯ (å‰ç«¯å®æ—¶å±•ç¤º)
2. StrategyEngine.process_kline() (ç­–ç•¥è¯„ä¼°)
3. PositionMonitor.process_quote() (ä»“ä½ç›‘æ§)
4. store_tick_event() (æŒä¹…åŒ–åˆ° DuckDB)
```

### äº¤æ˜“æ‰§è¡Œæµ

```
StrategyEngine è¯„ä¼°æ¡ä»¶
    â†“ (è§¦å‘ä¿¡å·)
execute_optimal_buy() / execute_sell()
    â†“ (è°ƒç”¨)
TradingAPI.place_order()
    â†“ (æäº¤)
Longbridge TradeContext
    â†“ (è¿”å›)
OrderResponse (æ›´æ–°ä»“ä½ã€å‘é€é€šçŸ¥)
    â†“
NotificationManager â†’ WebSocket â†’ å‰ç«¯æ˜¾ç¤º
```

### é…ç½®ç®¡ç†æµ

```
å‰ç«¯è®¾ç½®é¡µé¢
    â†“ (PUT /settings/credentials)
Routers.settings.update_credentials()
    â†“
Repositories.save_credentials() (åŠ å¯†å­˜å‚¨)
    â†“
DuckDB.settings è¡¨
    â†“ (é‡å¯è¡Œæƒ…æµ)
QuoteStreamManager.restart()
```

---

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. QuoteStreamManager (streaming.py)

**èŒè´£**ï¼š
- ç®¡ç† Longbridge è¡Œæƒ…è®¢é˜…
- ç»´æŠ¤ WebSocket å®¢æˆ·ç«¯è¿æ¥
- å½’ä¸€åŒ–è¡Œæƒ…æ•°æ®
- æ´¾å‘æ•°æ®åˆ°ç­–ç•¥å¼•æ“å’Œä»“ä½ç›‘æ§

**å…³é”®æ–¹æ³•**ï¼š
- `ensure_started()`: å¯åŠ¨è¡Œæƒ…æµçº¿ç¨‹
- `_subscription_loop()`: è®¢é˜…å¾ªç¯ï¼ˆè¿è¡Œåœ¨å•ç‹¬çº¿ç¨‹ï¼‰
- `_on_quote()`: å¤„ç†è¡Œæƒ…å›è°ƒ
- `_broadcast()`: å¹¿æ’­åˆ° WebSocket å®¢æˆ·ç«¯

### 2. StrategyEngine (strategy_engine.py)

**èŒè´£**ï¼š
- åŠ è½½ç­–ç•¥é…ç½®ï¼ˆstrategies.jsonï¼‰
- ç»´æŠ¤ K çº¿æ•°æ®ç¼“å†²åŒº
- è®¡ç®—æŠ€æœ¯æŒ‡æ ‡ï¼ˆMAã€RSIã€MACD ç­‰ï¼‰
- è¯„ä¼°ä¹°å–æ¡ä»¶
- æ‰§è¡Œäº¤æ˜“å†³ç­–

**å…³é”®æ–¹æ³•**ï¼š
- `process_kline()`: å¤„ç† K çº¿æ•°æ®
- `evaluate_strategy()`: è¯„ä¼°ç­–ç•¥æ¡ä»¶
- `evaluate_optimal_entry()`: æœ€ä¼˜å…¥åœºåˆ†æ
- `execute_optimal_buy()`: æ‰§è¡Œä¹°å…¥
- `execute_sell()`: æ‰§è¡Œå–å‡º

### 3. PositionMonitor (position_monitor.py)

**èŒè´£**ï¼š
- ç›‘æ§æ‰€æœ‰æŒä»“çš„å®æ—¶è¡Œæƒ…
- æ ¹æ®ä¸ªæ€§åŒ–é…ç½®æ‰§è¡Œç­–ç•¥
- é£é™©ç®¡ç†ï¼ˆæ­¢æŸã€æ­¢ç›ˆï¼‰
- å¸‚åœºæ—¶é—´æ£€æŸ¥

**å…³é”®æ–¹æ³•**ï¼š
- `initialize()`: åˆå§‹åŒ–ç›‘æ§ä»“ä½
- `process_quote()`: å¤„ç†å®æ—¶è¡Œæƒ…
- `check_risk_limits()`: é£é™©æ£€æŸ¥
- `evaluate_strategies()`: è¯„ä¼°ç­–ç•¥
- `execute_trade()`: æ‰§è¡Œäº¤æ˜“

### 4. TradingAPI (trading_api.py)

**èŒè´£**ï¼š
- å°è£… Longbridge TradeContext
- ä¸‹å•ã€æ’¤å•ã€æŸ¥è¯¢è®¢å•
- æŸ¥è¯¢è´¦æˆ·ä½™é¢ä¸æŒä»“

**å…³é”®æ–¹æ³•**ï¼š
- `place_order()`: ä¸‹å•
- `cancel_order()`: æ’¤å•
- `get_order_status()`: æŸ¥è¯¢è®¢å•çŠ¶æ€
- `get_account_balance()`: æŸ¥è¯¢ä½™é¢
- `get_positions()`: æŸ¥è¯¢æŒä»“

### 5. NotificationManager (notification_manager.py)

**èŒè´£**ï¼š
- ç®¡ç†å®æ—¶é€šçŸ¥
- WebSocket æ¨é€
- é€šçŸ¥å†å²è®°å½•

**å…³é”®æ–¹æ³•**ï¼š
- `send_notification()`: å‘é€é€šçŸ¥
- `send_trading_signal()`: å‘é€äº¤æ˜“ä¿¡å·é€šçŸ¥
- `send_order_update()`: å‘é€è®¢å•æ›´æ–°é€šçŸ¥
- `add_listener()`: æ·»åŠ  WebSocket ç›‘å¬å™¨

### 6. Repositories (repositories.py)

**èŒè´£**ï¼š
- æ•°æ®æŒä¹…åŒ–å°è£…
- å‡­æ®åŠ å¯†/è§£å¯†
- CRUD æ“ä½œ

**å…³é”®å‡½æ•°**ï¼š
- `save_credentials()` / `load_credentials()`
- `save_symbols()` / `load_symbols()`
- `store_candlesticks()` / `fetch_candlesticks()`
- `store_tick_event()` / `fetch_ticks()`
- `save_position_monitoring_config()`

---

## æ–‡ä»¶ä¸ç›®å½•è¯¦è§£

### åç«¯æ ¸å¿ƒæ–‡ä»¶

#### `/backend/app/main.py`
- **ä½œç”¨**ï¼šFastAPI åº”ç”¨å…¥å£
- **åŠŸèƒ½**ï¼š
  - åˆ›å»º FastAPI å®ä¾‹
  - é…ç½® CORS ä¸­é—´ä»¶
  - æ³¨å†Œæ‰€æœ‰è·¯ç”±å™¨
  - å®šä¹‰ startup/shutdown äº‹ä»¶
  - æä¾› WebSocket ç«¯ç‚¹ï¼ˆ`/ws/quotes`ï¼‰

#### `/backend/app/config.py`
- **ä½œç”¨**ï¼šé…ç½®ç®¡ç†
- **åŠŸèƒ½**ï¼š
  - å®šä¹‰ `Settings` ç±»ï¼ˆæ•°æ®åº“è·¯å¾„ã€åŠ å¯†å¯†é’¥ç­‰ï¼‰
  - æä¾› `get_settings()` å•ä¾‹
  - æä¾› Fernet åŠ å¯†å®ä¾‹
  - `ensure_dirs()` åˆ›å»ºå¿…è¦ç›®å½•

#### `/backend/app/db.py`
- **ä½œç”¨**ï¼šæ•°æ®åº“è¿æ¥ä¸è¿ç§»
- **åŠŸèƒ½**ï¼š
  - `get_connection()` è·å– DuckDB è¿æ¥
  - `_run_migrations()` æ‰§è¡Œ SQL è¿ç§»
  - `_ensure_column()` åŠ¨æ€æ·»åŠ åˆ—ï¼ˆè¡¥ä¸æœºåˆ¶ï¼‰

#### `/backend/app/models.py`
- **ä½œç”¨**ï¼šPydantic æ•°æ®æ¨¡å‹
- **åŠŸèƒ½**ï¼š
  - å®šä¹‰æ‰€æœ‰è¯·æ±‚/å“åº”æ¨¡å‹
  - å‡­æ®ã€ç¬¦å·åˆ—è¡¨ã€K çº¿ã€æŒä»“ç­‰
  - ç›‘æ§é…ç½®ã€ç­–ç•¥é…ç½®æ¨¡å‹

#### `/backend/app/services.py`
- **ä½œç”¨**ï¼šä¸šåŠ¡é€»è¾‘å±‚
- **åŠŸèƒ½**ï¼š
  - åˆ›å»º Longbridge ä¸Šä¸‹æ–‡ï¼ˆ`_quote_context()`, `_trade_context()`ï¼‰
  - åŒæ­¥å†å² K çº¿ï¼ˆ`sync_candlesticks()`ï¼‰
  - è·å–ç»„åˆæ¦‚è§ˆï¼ˆ`get_portfolio_overview()`ï¼‰
  - ç¼“å­˜è¯»å–ï¼ˆ`get_cached_candlesticks()`ï¼‰

#### `/backend/app/repositories.py`
- **ä½œç”¨**ï¼šæ•°æ®è®¿é—®å±‚
- **åŠŸèƒ½**ï¼š
  - æ‰€æœ‰æ•°æ®åº“ CRUD æ“ä½œ
  - å‡­æ®åŠ å¯†å­˜å‚¨
  - K çº¿ã€Tickã€æŒä»“æ•°æ®æŒä¹…åŒ–
  - ç›‘æ§é…ç½®ç®¡ç†

#### `/backend/app/exceptions.py`
- **ä½œç”¨**ï¼šè‡ªå®šä¹‰å¼‚å¸¸
- **åŠŸèƒ½**ï¼š
  - `LongbridgeDependencyMissing`ï¼ˆSDK æœªå®‰è£…ï¼‰
  - `LongbridgeAPIError`ï¼ˆAPI è°ƒç”¨å¤±è´¥ï¼‰

#### `/backend/app/streaming.py`
- **ä½œç”¨**ï¼šè¡Œæƒ…æµç®¡ç†
- **åŠŸèƒ½**ï¼š
  - `QuoteStreamManager` ç±»
  - ç®¡ç†è®¢é˜…çº¿ç¨‹
  - WebSocket å¹¿æ’­
  - æ´¾å‘æ•°æ®åˆ°ç­–ç•¥å¼•æ“å’Œä»“ä½ç›‘æ§

#### `/backend/app/strategy_engine.py`
- **ä½œç”¨**ï¼šç­–ç•¥å¼•æ“
- **åŠŸèƒ½**ï¼š
  - åŠ è½½ç­–ç•¥é…ç½®
  - K çº¿ç¼“å†²åŒºç®¡ç†
  - æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
  - æ¡ä»¶è¯„ä¼°ä¸äº¤æ˜“æ‰§è¡Œ
  - é›†æˆ TradingAPI å’Œ NotificationManager

#### `/backend/app/position_monitor.py`
- **ä½œç”¨**ï¼šä»“ä½ç›‘æ§ç³»ç»Ÿ
- **åŠŸèƒ½**ï¼š
  - ç›‘æ§æ‰€æœ‰æŒä»“
  - ä¸ªæ€§åŒ–ç­–ç•¥é…ç½®
  - é£é™©ç®¡ç†ï¼ˆæ­¢æŸã€æ­¢ç›ˆï¼‰
  - å¸‚åœºæ—¶é—´æ£€æŸ¥

#### `/backend/app/trading_api.py`
- **ä½œç”¨**ï¼šäº¤æ˜“ API å°è£…
- **åŠŸèƒ½**ï¼š
  - `LongbridgeTradingAPI` ç±»
  - ä¸‹å•ã€æ’¤å•ã€æŸ¥è¯¢
  - è®¢å•çŠ¶æ€æ˜ å°„
  - é”™è¯¯å¤„ç†

#### `/backend/app/notification_manager.py`
- **ä½œç”¨**ï¼šé€šçŸ¥ç®¡ç†ç³»ç»Ÿ
- **åŠŸèƒ½**ï¼š
  - `NotificationManager` ç±»
  - WebSocket æ¨é€
  - é€šçŸ¥å†å²
  - ä¸“ç”¨é€šçŸ¥æ–¹æ³•

#### `/backend/app/optimal_trading_signals.py`
- **ä½œç”¨**ï¼šæœ€ä¼˜ä¿¡å·åˆ†æ
- **åŠŸèƒ½**ï¼š
  - ç»¼åˆæŠ€æœ¯æŒ‡æ ‡åˆ†æ
  - è®¡ç®—ä¿¡å·ç½®ä¿¡åº¦
  - æ¨èæ­¢æŸ/æ­¢ç›ˆ/ä»“ä½å¤§å°

### åç«¯è·¯ç”±æ–‡ä»¶

#### `/backend/app/routers/settings.py`
- **ä½œç”¨**ï¼šè®¾ç½®ç›¸å…³ API
- **ç«¯ç‚¹**ï¼š
  - `GET /settings/credentials` - è·å–å‡­æ®
  - `PUT /settings/credentials` - æ›´æ–°å‡­æ®
  - `POST /settings/verify` - éªŒè¯å‡­æ®
  - `GET /settings/symbols` - è·å–ç¬¦å·åˆ—è¡¨
  - `PUT /settings/symbols` - æ›´æ–°ç¬¦å·åˆ—è¡¨

#### `/backend/app/routers/quotes.py`
- **ä½œç”¨**ï¼šè¡Œæƒ…ç›¸å…³ API
- **ç«¯ç‚¹**ï¼š
  - `POST /quotes/history/sync` - åŒæ­¥å†å²æ•°æ®
  - `GET /quotes/history` - æŸ¥è¯¢å†å² K çº¿
  - `GET /quotes/ticks` - æŸ¥è¯¢ Tick æ•°æ®
  - `GET /quotes/stream/status` - è¡Œæƒ…æµçŠ¶æ€

#### `/backend/app/routers/portfolio.py`
- **ä½œç”¨**ï¼šç»„åˆç›¸å…³ API
- **ç«¯ç‚¹**ï¼š
  - `GET /portfolio/positions` - è·å–æŒä»“
  - `GET /portfolio/overview` - ç»„åˆæ¦‚è§ˆ

#### `/backend/app/routers/strategies.py`
- **ä½œç”¨**ï¼šç­–ç•¥ç®¡ç† API
- **ç«¯ç‚¹**ï¼š
  - `GET /strategies/` - è·å–æ‰€æœ‰ç­–ç•¥
  - `GET /strategies/status` - ç­–ç•¥çŠ¶æ€
  - `PUT /strategies/{id}` - æ›´æ–°ç­–ç•¥
  - `POST /strategies/{id}/enable` - å¯ç”¨ç­–ç•¥
  - `POST /strategies/reload` - é‡æ–°åŠ è½½é…ç½®

#### `/backend/app/routers/monitoring.py`
- **ä½œç”¨**ï¼šç›‘æ§ç®¡ç† API
- **ç«¯ç‚¹**ï¼š
  - `GET /monitoring/positions` - è·å–ç›‘æ§ä»“ä½
  - `PUT /monitoring/positions/{symbol}` - æ›´æ–°ä»“ä½é…ç½®
  - `GET /monitoring/global-settings` - å…¨å±€è®¾ç½®
  - `GET /monitoring/status` - ç›‘æ§çŠ¶æ€

#### `/backend/app/routers/notifications.py`
- **ä½œç”¨**ï¼šé€šçŸ¥ API
- **ç«¯ç‚¹**ï¼š
  - `GET /notifications/` - è·å–é€šçŸ¥å†å²
  - `POST /notifications/{id}/read` - æ ‡è®°å·²è¯»
  - `DELETE /notifications/` - æ¸…ç©ºé€šçŸ¥
  - `WS /notifications/ws` - å®æ—¶é€šçŸ¥æµ

#### `/backend/app/routers/signal_analysis.py`
- **ä½œç”¨**ï¼šä¿¡å·åˆ†æ API
- **ç«¯ç‚¹**ï¼š
  - æä¾›æœ€ä¼˜ä¿¡å·åˆ†ææ¥å£

### å‰ç«¯æ ¸å¿ƒæ–‡ä»¶

#### `/frontend/src/main.tsx`
- **ä½œç”¨**ï¼šåº”ç”¨å…¥å£
- **åŠŸèƒ½**ï¼š
  - æ¸²æŸ“ React æ ¹ç»„ä»¶
  - åŠ è½½å…¨å±€æ ·å¼

#### `/frontend/src/App.tsx`
- **ä½œç”¨**ï¼šä¸»åº”ç”¨ç»„ä»¶
- **åŠŸèƒ½**ï¼š
  - é¡¶éƒ¨ Tab å¯¼èˆª
  - è·¯ç”±åˆ‡æ¢é€»è¾‘
  - æ·±è‰²æ¨¡å¼åˆ‡æ¢

#### `/frontend/src/api/client.ts`
- **ä½œç”¨**ï¼šAPI å®¢æˆ·ç«¯åŸºç¡€
- **åŠŸèƒ½**ï¼š
  - ç»Ÿä¸€çš„ `fetch` å°è£…
  - é”™è¯¯å¤„ç†ï¼ˆ`handleResponse`ï¼‰
  - WebSocket URL è§£æï¼ˆ`resolveWsUrl`ï¼‰
  - æ‰€æœ‰ REST API æ–¹æ³•

#### `/frontend/src/api/quotes.ts`
- **ä½œç”¨**ï¼šè¡Œæƒ…ä¸“ç”¨ API
- **åŠŸèƒ½**ï¼š
  - è¡Œæƒ…ç›¸å…³æ¥å£å°è£…

#### `/frontend/src/pages/Settings.tsx`
- **ä½œç”¨**ï¼šè®¾ç½®é¡µé¢
- **åŠŸèƒ½**ï¼š
  - å‡­æ®é…ç½®è¡¨å•
  - ç¬¦å·åˆ—è¡¨é…ç½®
  - å†å²æ•°æ®åŒæ­¥

#### `/frontend/src/pages/RealtimeSimple.tsx`
- **ä½œç”¨**ï¼šå®æ—¶è¡Œæƒ…é¡µé¢
- **åŠŸèƒ½**ï¼š
  - WebSocket è¿æ¥
  - å®æ—¶è¡Œæƒ…å±•ç¤º

#### `/frontend/src/pages/RealtimeKLine.tsx`
- **ä½œç”¨**ï¼šå®æ—¶ K çº¿é¡µé¢
- **åŠŸèƒ½**ï¼š
  - K çº¿å›¾è¡¨å±•ç¤º
  - WebSocket å®æ—¶æ›´æ–°

#### `/frontend/src/pages/History.tsx`
- **ä½œç”¨**ï¼šå†å²æ•°æ®é¡µé¢
- **åŠŸèƒ½**ï¼š
  - æŸ¥è¯¢å†å² K çº¿
  - å›¾è¡¨å±•ç¤º

#### `/frontend/src/pages/StrategyControl.tsx`
- **ä½œç”¨**ï¼šç­–ç•¥æ§åˆ¶é¡µé¢
- **åŠŸèƒ½**ï¼š
  - ç­–ç•¥åˆ—è¡¨å±•ç¤º
  - å¯ç”¨/ç¦ç”¨ç­–ç•¥
  - ç­–ç•¥å‚æ•°é…ç½®

#### `/frontend/src/pages/PositionMonitoring.tsx`
- **ä½œç”¨**ï¼šä»“ä½ç›‘æ§é¡µé¢
- **åŠŸèƒ½**ï¼š
  - ç›‘æ§ä»“ä½åˆ—è¡¨
  - é…ç½®ç›‘æ§å‚æ•°
  - é£é™©ç®¡ç†è®¾ç½®

#### `/frontend/src/pages/SignalAnalysis.tsx`
- **ä½œç”¨**ï¼šä¿¡å·åˆ†æé¡µé¢
- **åŠŸèƒ½**ï¼š
  - æœ€ä¼˜ä¿¡å·å±•ç¤º
  - ä¿¡å·å†å²è®°å½•

#### `/frontend/src/components/`
- **KLineChart.tsx**: K çº¿å›¾è¡¨ç»„ä»¶
- **StatusSnackbar.tsx**: çŠ¶æ€æç¤ºç»„ä»¶
- **LoadingSpinner.tsx**: åŠ è½½åŠ¨ç”»ç»„ä»¶

### é…ç½®æ–‡ä»¶

#### `/config/strategies.json`
- **ä½œç”¨**ï¼šç­–ç•¥é…ç½®
- **å†…å®¹**ï¼š
  - ç­–ç•¥å®šä¹‰ï¼ˆæ¡ä»¶ã€å‚æ•°ï¼‰
  - å…¨å±€è®¾ç½®ï¼ˆé£é™©é™åˆ¶ï¼‰
  - é€šçŸ¥è®¾ç½®

#### `/backend/pyproject.toml`
- **ä½œç”¨**ï¼šPython é¡¹ç›®é…ç½®
- **å†…å®¹**ï¼š
  - ä¾èµ–åŒ…åˆ—è¡¨
  - é¡¹ç›®å…ƒæ•°æ®

#### `/frontend/package.json`
- **ä½œç”¨**ï¼šNode.js é¡¹ç›®é…ç½®
- **å†…å®¹**ï¼š
  - npm ä¾èµ–
  - è„šæœ¬å‘½ä»¤
  - é¡¹ç›®å…ƒæ•°æ®

#### `/frontend/vite.config.ts`
- **ä½œç”¨**ï¼šVite æ„å»ºé…ç½®
- **å†…å®¹**ï¼š
  - å¼€å‘æœåŠ¡å™¨é…ç½®
  - æ„å»ºä¼˜åŒ–é€‰é¡¹

#### `/frontend/tsconfig.json`
- **ä½œç”¨**ï¼šTypeScript é…ç½®
- **å†…å®¹**ï¼š
  - ç¼–è¯‘é€‰é¡¹
  - ç±»å‹æ£€æŸ¥è®¾ç½®

### æ•°æ®æ–‡ä»¶

#### `/backend/data/quant.db`
- **ä½œç”¨**ï¼šDuckDB æ•°æ®åº“æ–‡ä»¶
- **è¡¨ç»“æ„**ï¼š
  - `settings` - é…ç½®ä¿¡æ¯ï¼ˆå‡­æ®åŠ å¯†å­˜å‚¨ï¼‰
  - `symbols` - è‚¡ç¥¨ä»£ç åˆ—è¡¨
  - `ohlc` - K çº¿æ•°æ®
  - `ticks` - Tick æ•°æ®
  - `positions` - æŒä»“å¿«ç…§
  - `position_monitoring` - ä»“ä½ç›‘æ§é…ç½®
  - `global_monitoring_settings` - å…¨å±€ç›‘æ§è®¾ç½®

#### `/logs/backend.log`
- **ä½œç”¨**ï¼šåç«¯æ—¥å¿—
- **å†…å®¹**ï¼š
  - INFOã€WARNINGã€ERROR æ—¥å¿—
  - äº¤æ˜“æ‰§è¡Œè®°å½•
  - å¼‚å¸¸å †æ ˆ

#### `/logs/frontend.log`
- **ä½œç”¨**ï¼šå‰ç«¯æ—¥å¿—
- **å†…å®¹**ï¼š
  - å‰ç«¯è¿è¡Œæ—¥å¿—

### æ–‡æ¡£æ–‡ä»¶

#### `/docs/ARCHITECTURE.md`
- **ä½œç”¨**ï¼šæ¶æ„æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰

#### `/docs/DECISIONS.md`
- **ä½œç”¨**ï¼šæ¶æ„å†³ç­–è®°å½•ï¼ˆADRï¼‰

#### `/docs/README.md`
- **ä½œç”¨**ï¼šæ–‡æ¡£è¯´æ˜

#### `/docs/rules.md`
- **ä½œç”¨**ï¼šç¼–ç è§„èŒƒ

#### `/docs/llms.txt`
- **ä½œç”¨**ï¼šLLM æç¤ºè¯

#### `/.cursor/rules/*.mdc`
- **ä½œç”¨**ï¼šCursor IDE è§„åˆ™
- **å†…å®¹**ï¼š14 ä¸ªè§„åˆ™æ–‡ä»¶ï¼Œè¦†ç›–å„ä¸ªæ¨¡å—

### è„šæœ¬æ–‡ä»¶

#### `/start.sh` / `/start.bat`
- **ä½œç”¨**ï¼šå¯åŠ¨è„šæœ¬
- **åŠŸèƒ½**ï¼š
  - å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼ˆuvicornï¼‰
  - å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆnpmï¼‰

#### `/stop.sh` / `/stop.bat`
- **ä½œç”¨**ï¼šåœæ­¢è„šæœ¬
- **åŠŸèƒ½**ï¼š
  - åœæ­¢æ‰€æœ‰æœåŠ¡

#### `/start_trading.py`
- **ä½œç”¨**ï¼šäº¤æ˜“å¯åŠ¨è„šæœ¬
- **åŠŸèƒ½**ï¼š
  - å¯åŠ¨ç­–ç•¥å¼•æ“
  - å¯åŠ¨ä»“ä½ç›‘æ§

#### `/scripts/update_llms.sh`
- **ä½œç”¨**ï¼šæ›´æ–° LLM æç¤ºè¯
- **åŠŸèƒ½**ï¼š
  - ç”Ÿæˆæœ€æ–°çš„ llms.txt

---

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ

```
å¼€å‘æœºå™¨
â”œâ”€â”€ åç«¯ï¼šuvicorn --reload (ç«¯å£ 8000)
â”œâ”€â”€ å‰ç«¯ï¼šnpm run dev (ç«¯å£ 5173)
â””â”€â”€ æ•°æ®åº“ï¼šDuckDB (åµŒå…¥å¼)
```

### ç”Ÿäº§ç¯å¢ƒ

```
æœåŠ¡å™¨
â”œâ”€â”€ åç«¯ï¼šuvicorn (å¤šè¿›ç¨‹)
â”œâ”€â”€ å‰ç«¯ï¼šnginx (é™æ€æ–‡ä»¶)
â”œâ”€â”€ æ•°æ®åº“ï¼šDuckDB (æŒä¹…åŒ–å­˜å‚¨)
â””â”€â”€ è¿›ç¨‹ç®¡ç†ï¼šsystemd / supervisor
```

---

## å®‰å…¨æœºåˆ¶

### 1. å‡­æ®åŠ å¯†
- ä½¿ç”¨ Fernet å¯¹ç§°åŠ å¯†
- å¯†é’¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶
- æ•°æ®åº“ä¸­ä»…å­˜å‚¨åŠ å¯†åçš„æ•°æ®

### 2. API å®‰å…¨
- CORS é…ç½®é™åˆ¶è·¨åŸŸè®¿é—®
- è¾“å…¥éªŒè¯ï¼ˆPydantic æ¨¡å‹ï¼‰
- å¼‚å¸¸ç»Ÿä¸€å¤„ç†

### 3. æ•°æ®éš”ç¦»
- æœ¬åœ° DuckDB æ•°æ®åº“
- æ— å¤–éƒ¨æ•°æ®æ³„éœ²é£é™©

---

## æ€§èƒ½ä¼˜åŒ–

### 1. åç«¯
- å¼‚æ­¥ I/Oï¼ˆasyncioï¼‰
- æ•°æ®åº“è¿æ¥æ± 
- ç¼“å­˜æœºåˆ¶ï¼ˆå†…å­˜ç¼“å­˜ K çº¿æ•°æ®ï¼‰

### 2. å‰ç«¯
- React ç»„ä»¶æ‡’åŠ è½½
- WebSocket å¤ç”¨
- Vite æ„å»ºä¼˜åŒ–

### 3. æ•°æ®åº“
- ç´¢å¼•ä¼˜åŒ–ï¼ˆsymbol, tsï¼‰
- æ‰¹é‡æ’å…¥ï¼ˆexecutemanyï¼‰
- å®šæœŸæ¸…ç†æ—§æ•°æ®

---

## ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—çº§åˆ«
- **DEBUG**: è°ƒè¯•ä¿¡æ¯ï¼ˆé»˜è®¤å…³é—­ï¼‰
- **INFO**: å¸¸è§„ä¿¡æ¯ï¼ˆé»˜è®¤å¼€å¯ï¼‰
- **WARNING**: è­¦å‘Š
- **ERROR**: é”™è¯¯
- **CRITICAL**: ä¸¥é‡é”™è¯¯

### æ—¥å¿—ä½ç½®
- `/logs/backend.log` - åç«¯æ—¥å¿—
- `/logs/frontend.log` - å‰ç«¯æ—¥å¿—

### ç›‘æ§æŒ‡æ ‡
- è¡Œæƒ…æµçŠ¶æ€ï¼ˆè¿æ¥ã€è®¢é˜…æ•°ï¼‰
- ç­–ç•¥æ‰§è¡Œæ¬¡æ•°
- äº¤æ˜“æˆåŠŸ/å¤±è´¥æ•°
- ä»“ä½ç›‘æ§çŠ¶æ€
- ç³»ç»Ÿèµ„æºä½¿ç”¨

---

## æ‰©å±•æ€§

### 1. æ–°å¢ç­–ç•¥
- åœ¨ `config/strategies.json` æ·»åŠ é…ç½®
- æ”¯æŒçƒ­é‡è½½ï¼ˆæ— éœ€é‡å¯ï¼‰

### 2. æ–°å¢æŠ€æœ¯æŒ‡æ ‡
- åœ¨ `TechnicalIndicators` ç±»æ·»åŠ æ–¹æ³•
- åœ¨ `evaluate_single_condition()` æ·»åŠ æ¡ä»¶ç±»å‹

### 3. æ–°å¢ API ç«¯ç‚¹
- åœ¨ `routers/` åˆ›å»ºæ–°è·¯ç”±æ–‡ä»¶
- åœ¨ `main.py` æ³¨å†Œè·¯ç”±

### 4. æ–°å¢å‰ç«¯é¡µé¢
- åœ¨ `pages/` åˆ›å»ºæ–°ç»„ä»¶
- åœ¨ `App.tsx` æ·»åŠ  Tab

---

## ç»´æŠ¤å»ºè®®

### 1. å®šæœŸå¤‡ä»½
- å¤‡ä»½ `data/quant.db` æ•°æ®åº“æ–‡ä»¶
- å¤‡ä»½ `config/strategies.json` é…ç½®

### 2. æ—¥å¿—æ¸…ç†
- å®šæœŸæ¸…ç† `logs/` ç›®å½•
- è®¾ç½®æ—¥å¿—è½®è½¬

### 3. ä¾èµ–æ›´æ–°
- å®šæœŸæ›´æ–° Python/npm ä¾èµ–
- æµ‹è¯•å…¼å®¹æ€§

### 4. æ€§èƒ½ç›‘æ§
- ç›‘æ§å†…å­˜ä½¿ç”¨ï¼ˆK çº¿ç¼“å†²åŒºï¼‰
- ç›‘æ§ CPU ä½¿ç”¨ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰
- ç›‘æ§ç£ç›˜ç©ºé—´ï¼ˆæ•°æ®åº“å¢é•¿ï¼‰

---

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°çš„è‚¡ç¥¨ä»£ç ï¼Ÿ
A: è®¿é—®è®¾ç½®é¡µé¢ï¼Œåœ¨"è‚¡ç¥¨åˆ—è¡¨é…ç½®"ä¸­æ·»åŠ ã€‚

### Q: ç­–ç•¥ä¸æ‰§è¡Œæ€ä¹ˆåŠï¼Ÿ
A: æ£€æŸ¥ï¼š
1. ç­–ç•¥æ˜¯å¦å¯ç”¨ï¼ˆ`enabled: true`ï¼‰
2. K çº¿ç¼“å†²åŒºæ˜¯å¦æœ‰è¶³å¤Ÿæ•°æ®ï¼ˆâ‰¥50 æ¡ï¼‰
3. é£é™©é™åˆ¶æ˜¯å¦è§¦å‘ï¼ˆå•æ—¥äº¤æ˜“æ•°ã€ä»“ä½é™åˆ¶ç­‰ï¼‰
4. æŸ¥çœ‹æ—¥å¿— `logs/backend.log`

### Q: å¦‚ä½•åœæ­¢è‡ªåŠ¨äº¤æ˜“ï¼Ÿ
A: 
1. è®¿é—®ç­–ç•¥æ§åˆ¶é¡µé¢ï¼Œç¦ç”¨æ‰€æœ‰ç­–ç•¥
2. æˆ–è®¾ç½®å…¨å±€ç›‘æ§ `emergency_stop=True`

### Q: æ•°æ®åº“æ–‡ä»¶è¿‡å¤§æ€ä¹ˆåŠï¼Ÿ
A: 
1. å®šæœŸæ¸…ç†æ—§æ•°æ®ï¼ˆSQL DELETEï¼‰
2. ä½¿ç”¨ DuckDB çš„ VACUUM å‘½ä»¤å‹ç¼©
3. é™åˆ¶å†å²æ•°æ®ä¿ç•™æ—¶é—´

---

## æ€»ç»“

æœ¬ç³»ç»Ÿé‡‡ç”¨**å‰åç«¯åˆ†ç¦»**æ¶æ„ï¼Œåç«¯ä½¿ç”¨ **FastAPI + DuckDB**ï¼Œå‰ç«¯ä½¿ç”¨ **React + TypeScript**ã€‚æ ¸å¿ƒå¼•æ“åŒ…æ‹¬ï¼š

1. **è¡Œæƒ…æµç®¡ç†**ï¼ˆå®æ—¶è®¢é˜…ä¸æ´¾å‘ï¼‰
2. **ç­–ç•¥å¼•æ“**ï¼ˆè‡ªåŠ¨äº¤æ˜“å†³ç­–ï¼‰
3. **ä»“ä½ç›‘æ§**ï¼ˆé£é™©ç®¡ç†ï¼‰
4. **é€šçŸ¥ç³»ç»Ÿ**ï¼ˆå®æ—¶æ¨é€ï¼‰

ç³»ç»Ÿè®¾è®¡éµå¾ª**å•ä¸€èŒè´£åŸåˆ™**ã€**åˆ†å±‚æ¶æ„**ã€**ä¾èµ–æ³¨å…¥**ç­‰æœ€ä½³å®è·µï¼Œå…·æœ‰è‰¯å¥½çš„**å¯æ‰©å±•æ€§**ã€**å¯ç»´æŠ¤æ€§**å’Œ**æ€§èƒ½**ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-10-03  
**ç»´æŠ¤è€…**: Longbridge Quant Team

