# ç­–ç•¥ç›¯ç›˜æ•…éšœæ’æŸ¥æŒ‡å— ğŸ”§

## é—®é¢˜ï¼šç­–ç•¥ç›¯ç›˜æ˜¾ç¤º"å½“å‰æ²¡æœ‰ä¿¡å·"

### ç°è±¡
- æ‰“å¼€"ç­–ç•¥ç›¯ç›˜ ğŸ¯"é¡µé¢
- çœ‹åˆ°"å½“å‰æ²¡æœ‰ä¿¡å·ï¼Œè¯·é…ç½®ç›‘æ§è‚¡ç¥¨"æˆ–ç©ºç™½è¡¨æ ¼
- æ˜æ˜æœ‰æŒä»“è‚¡ç¥¨ï¼Œä½†æ˜¯ä¸æ˜¾ç¤º

---

## åŸå› åˆ†æ

ç­–ç•¥ç›¯ç›˜éœ€è¦**å†å²Kçº¿æ•°æ®**æ‰èƒ½ç”Ÿæˆä¿¡å·ã€‚å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰Kçº¿æ•°æ®ï¼Œå°±æ— æ³•åˆ†æï¼š

```
æŒä»“è‚¡ç¥¨ âœ…  â†’  ç­–ç•¥åˆ†æ âŒ  â†’  æ˜¾ç¤ºä¿¡å· âŒ
                â†‘
             éœ€è¦Kçº¿æ•°æ®
```

**å¸¸è§åŸå› ï¼š**
1. âŒ **ACCESS_TOKEN æ— æ•ˆæˆ–è¿‡æœŸ** â†’ æ— æ³•åŒæ­¥æ•°æ®
2. âŒ **ä»æœªåŒæ­¥è¿‡å†å²æ•°æ®** â†’ æ•°æ®åº“ä¸ºç©º
3. âŒ **ç½‘ç»œé—®é¢˜** â†’ åŒæ­¥å¤±è´¥

---

## è§£å†³æ–¹æ¡ˆ

### æ­¥éª¤ 1ï¼šæ£€æŸ¥ ACCESS_TOKEN

**ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**
- ACCESS_TOKEN æ˜¯è®¿é—® Longbridge API çš„å‡­è¯
- è¿‡æœŸæˆ–æ— æ•ˆçš„ TOKEN ä¼šå¯¼è‡´æ‰€æœ‰æ¥å£è°ƒç”¨å¤±è´¥
- åŒ…æ‹¬ï¼šè·å–æŒä»“ã€åŒæ­¥Kçº¿ã€å®æ—¶è¡Œæƒ…ç­‰

**å¦‚ä½•æ£€æŸ¥ï¼Ÿ**

1. è®¿é—® `http://localhost:5173`
2. ç‚¹å‡»ã€ŒåŸºç¡€é…ç½® âš™ï¸ã€
3. ç‚¹å‡»ã€ŒéªŒè¯ã€æŒ‰é’®

**å¯èƒ½çš„é”™è¯¯ï¼š**

| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|--------|---------|---------|
| 401003 | token expired | TOKENå·²è¿‡æœŸï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ |
| 401004 | token invalid | TOKENæ— æ•ˆï¼Œæ£€æŸ¥æ˜¯å¦å®Œæ•´å¤åˆ¶ |
| 401005 | invalid app key/secret | APP_KEY æˆ– APP_SECRET é”™è¯¯ |

**å¦‚ä½•æ›´æ–° ACCESS_TOKENï¼Ÿ**

1. è®¿é—® Longbridge å¼€æ”¾å¹³å°ï¼šhttps://open.longbridgeapp.com/
2. ç™»å½•ä½ çš„è´¦æˆ·
3. è¿›å…¥ã€Œåº”ç”¨ç®¡ç†ã€
4. æ‰¾åˆ°ä½ çš„åº”ç”¨
5. ç‚¹å‡»ã€Œé‡æ–°ç”Ÿæˆ Access Tokenã€
6. **é‡è¦**ï¼šé€‰æ‹©ã€Œé•¿æœŸ Tokenã€ç±»å‹
7. å¤åˆ¶æ–°çš„ TOKENï¼ˆå®Œæ•´å¤åˆ¶ï¼Œä¸è¦æœ‰ç©ºæ ¼ï¼‰
8. å›åˆ°ç³»ç»Ÿã€ŒåŸºç¡€é…ç½®ã€é¡µé¢
9. ç²˜è´´æ–°çš„ ACCESS_TOKEN
10. ç‚¹å‡»ã€ŒéªŒè¯ã€â†’ã€Œä¿å­˜ã€

---

### æ­¥éª¤ 2ï¼šåŒæ­¥å†å²Kçº¿æ•°æ®

**ä¸¤ç§æ–¹æ³•ä»»é€‰å…¶ä¸€ï¼š**

#### æ–¹æ³• Aï¼šä½¿ç”¨ Web ç•Œé¢ï¼ˆæ¨èï¼‰

1. è®¿é—® `http://localhost:5173`
2. ç‚¹å‡»ã€Œå…³äºè¡Œæƒ… ğŸ“Šã€æ ‡ç­¾
3. æ‰¾åˆ°ã€ŒåŒæ­¥å†å²æ•°æ®ã€æŒ‰é’®
4. ç‚¹å‡»åç­‰å¾…åŒæ­¥å®Œæˆ
5. å®Œæˆåå›åˆ°ã€Œç­–ç•¥ç›¯ç›˜ ğŸ¯ã€åˆ·æ–°

#### æ–¹æ³• Bï¼šä½¿ç”¨å‘½ä»¤è¡Œè„šæœ¬

```bash
cd /Volumes/SamSung/longbridge
python3 sync_position_data.py
```

**åŒæ­¥è¿‡ç¨‹ç¤ºä¾‹ï¼š**
```
============================================================
åŒæ­¥æŒä»“è‚¡ç¥¨Kçº¿æ•°æ®
============================================================

ğŸ“Š è·å–æŒä»“è‚¡ç¥¨...
âœ… æ£€æµ‹åˆ° 14 åªæŒä»“è‚¡ç¥¨:
   - UMC.US
   - TSEM.US
   - JD.US
   ...

ğŸ¯ æ€»è®¡éœ€è¦åŒæ­¥ 14 åªè‚¡ç¥¨
============================================================

[1/14] åŒæ­¥ UMC.US...
   âœ… æˆåŠŸåŒæ­¥ 100 æ¡Kçº¿æ•°æ®

[2/14] åŒæ­¥ TSEM.US...
   âœ… æˆåŠŸåŒæ­¥ 100 æ¡Kçº¿æ•°æ®

...

åŒæ­¥å®Œæˆï¼
âœ… æˆåŠŸ: 14 åª
âŒ å¤±è´¥: 0 åª
```

---

### æ­¥éª¤ 3ï¼šéªŒè¯æ•°æ®

**æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰Kçº¿æ•°æ®ï¼š**

```bash
cd /Volumes/SamSung/longbridge
python3 -c "
import duckdb
conn = duckdb.connect('data/quant.db', read_only=True)
result = conn.execute('''
    SELECT symbol, COUNT(*) as count
    FROM ohlc
    GROUP BY symbol
    ORDER BY count DESC
    LIMIT 10
''').fetchall()
print('Kçº¿æ•°æ®ç»Ÿè®¡:')
for row in result:
    print(f'  {row[0]:15} {row[1]:6} æ¡')
conn.close()
"
```

**é¢„æœŸè¾“å‡ºï¼š**
```
Kçº¿æ•°æ®ç»Ÿè®¡:
  UMC.US          100 æ¡
  TSEM.US         100 æ¡
  JD.US           100 æ¡
  ...
```

å¦‚æœè¾“å‡ºä¸ºç©ºï¼Œè¯´æ˜æ•°æ®åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ TOKENã€‚

---

### æ­¥éª¤ 4ï¼šæŸ¥çœ‹ç­–ç•¥ç›¯ç›˜

1. è®¿é—® `http://localhost:5173`
2. ç‚¹å‡»ã€Œç­–ç•¥ç›¯ç›˜ ğŸ¯ã€
3. ç­‰å¾…åŠ è½½ï¼ˆç¬¬ä¸€æ¬¡å¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼‰

**ç°åœ¨åº”è¯¥èƒ½çœ‹åˆ°ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç­–ç•¥ç›¯ç›˜                  [æŒä»“ 14 | ç›‘æ§ 4] [å…± 18 åª]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  è‚¡ç¥¨           å½“å‰ä»·   ä¹°ä½å–é«˜   EMAäº¤å‰   ç»¼åˆå»ºè®®
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  UMC.US [æŒä»“]   $7.50   ğŸŸ¢BUY     ğŸŸ¢BUY    ğŸŸ¢ BUY
  TSEM.US [æŒä»“]  $72.90   -        ğŸ”´SELL   ğŸ”´ SELL
  JD.US [æŒä»“]    $33.06  ğŸ”´SELL     -       ğŸ”´ SELL
  ...
```

---

## å¸¸è§é—®é¢˜ FAQ

### Q1: ä¸ºä»€ä¹ˆåŒæ­¥åè¿˜æ˜¯æ²¡æœ‰ä¿¡å·ï¼Ÿ

**å¯èƒ½åŸå› ï¼š**
1. Kçº¿æ•°æ®ä¸è¶³ï¼ˆå°‘äº30æ¡ï¼‰â†’ ç­–ç•¥æ— æ³•è®¡ç®—
2. è‚¡ç¥¨æœ€è¿‘æ²¡æœ‰äº¤æ˜“ï¼ˆåœç‰Œã€é€€å¸‚ï¼‰â†’ æ— æœ€æ–°æ•°æ®
3. ç­–ç•¥åˆ¤æ–­å½“å‰æ— æ˜æ˜¾ä¿¡å· â†’ è¿™æ˜¯æ­£å¸¸çš„

**è§£å†³åŠæ³•ï¼š**
- æ£€æŸ¥è¯¥è‚¡ç¥¨æ˜¯å¦æ­£å¸¸äº¤æ˜“
- å°è¯•åŒæ­¥æ›´å¤šå¤©æ•°çš„æ•°æ®ï¼ˆä¿®æ”¹ `limit` å‚æ•°ï¼‰
- è€å¿ƒç­‰å¾…ï¼Œç­–ç•¥åªåœ¨æœ‰æ˜ç¡®ä¿¡å·æ—¶æ‰æç¤º

---

### Q2: æŒä»“è‚¡ç¥¨æ•°é‡ä¸å¯¹ï¼Ÿ

**æ£€æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ API æ˜¯å¦æ­£å¸¸
curl -s http://localhost:8000/portfolio/positions | python3 -m json.tool

# 2. æ£€æŸ¥ TOKEN æ˜¯å¦æœ‰æ•ˆ
curl -s http://localhost:8000/settings/credentials | python3 -m json.tool
```

å¦‚æœè¿”å›é”™è¯¯ï¼Œè¯·æ›´æ–° ACCESS_TOKENã€‚

---

### Q3: å¦‚ä½•æ‰‹åŠ¨æ·»åŠ ç›‘æ§è‚¡ç¥¨ï¼Ÿ

**é€šè¿‡ç•Œé¢ï¼š**
1. è®¿é—®ã€ŒåŸºç¡€é…ç½® âš™ï¸ã€
2. åœ¨ã€Œç›‘æ§è‚¡ç¥¨ã€è¾“å…¥æ¡†ä¸­è¾“å…¥è‚¡ç¥¨ä»£ç ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰
3. ä¾‹å¦‚ï¼š`AAPL.US, TSLA.US, NVDA.US`
4. ç‚¹å‡»ã€Œä¿å­˜ã€

**é€šè¿‡å‘½ä»¤è¡Œï¼š**
```bash
curl -X PUT http://localhost:8000/settings/symbols \
  -H "Content-Type: application/json" \
  -d '{
    "symbols": ["AAPL.US", "TSLA.US", "NVDA.US"]
  }'
```

---

### Q4: åŒæ­¥æ•°æ®å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ

**æ­£å¸¸é€Ÿåº¦ï¼š**
- æ¯åªè‚¡ç¥¨çº¦ 1-3 ç§’
- 14 åªè‚¡ç¥¨çº¦ 20-40 ç§’

**å¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ Longbridge API æ˜¯å¦æ­£å¸¸ï¼ˆè®¿é—® https://open.longbridgeapp.com/ï¼‰
3. å°è¯•å‡å°‘åŒæ­¥æ•°é‡ï¼ˆåˆ†æ‰¹åŒæ­¥ï¼‰

---

### Q5: é”™è¯¯æç¤º"token expired"æ€ä¹ˆåŠï¼Ÿ

è¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜ï¼**ACCESS_TOKEN æœ‰æ•ˆæœŸé™åˆ¶**ï¼š

- âœ… **é•¿æœŸ Token**ï¼šæœ‰æ•ˆæœŸ 1 å¹´
- âŒ **çŸ­æœŸ Token**ï¼šæœ‰æ•ˆæœŸ 7 å¤©

**è§£å†³åŠæ³•ï¼š**
1. é‡æ–°ç”Ÿæˆ ACCESS_TOKENï¼ˆå‚è€ƒæ­¥éª¤1ï¼‰
2. **ç¡®ä¿é€‰æ‹©ã€Œé•¿æœŸ Tokenã€ç±»å‹**
3. ä¿å­˜å¥½æ–°çš„ TOKENï¼Œé¿å…é¢‘ç¹æ›´æ–°

---

## å¿«é€Ÿè¯Šæ–­å‘½ä»¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¸€é”®æ£€æŸ¥æ‰€æœ‰é—®é¢˜ï¼š

```bash
cd /Volumes/SamSung/longbridge

echo "====== 1. æ£€æŸ¥åç«¯æœåŠ¡ ======"
curl -s http://localhost:8000/health && echo "âœ… åç«¯æ­£å¸¸" || echo "âŒ åç«¯æœªå¯åŠ¨"

echo -e "\n====== 2. æ£€æŸ¥å‡­æ®çŠ¶æ€ ======"
curl -s http://localhost:8000/settings/credentials | python3 -m json.tool 2>&1 | head -10

echo -e "\n====== 3. æ£€æŸ¥æŒä»“æ•°é‡ ======"
curl -s http://localhost:8000/portfolio/overview | python3 -c "
import sys, json
try:
    data = json.load(sys.stdin)
    print(f\"âœ… æŒä»“è‚¡ç¥¨: {len(data.get('positions', []))} åª\")
except Exception as e:
    print(f\"âŒ è·å–æŒä»“å¤±è´¥: {e}\")
"

echo -e "\n====== 4. æ£€æŸ¥Kçº¿æ•°æ® ======"
python3 -c "
import duckdb
conn = duckdb.connect('data/quant.db', read_only=True)
try:
    result = conn.execute('SELECT COUNT(DISTINCT symbol) FROM ohlc').fetchone()
    print(f'âœ… å·²åŒæ­¥ {result[0]} åªè‚¡ç¥¨çš„Kçº¿æ•°æ®')
except Exception as e:
    print(f'âŒ æ•°æ®åº“æŸ¥è¯¢å¤±è´¥: {e}')
conn.close()
"

echo -e "\n====== 5. æ£€æŸ¥ç­–ç•¥ä¿¡å· ======"
curl -s http://localhost:8000/strategies/advanced/watchlist/signals | python3 -c "
import sys, json
try:
    data = json.load(sys.stdin)
    print(f\"âœ… æŒä»“: {data.get('position_count', 0)} | ç›‘æ§: {data.get('manual_count', 0)} | ä¿¡å·: {len(data.get('signals', []))} æ¡\")
except Exception as e:
    print(f\"âŒ è·å–ä¿¡å·å¤±è´¥: {e}\")
"
```

**é¢„æœŸæ­£å¸¸è¾“å‡ºï¼š**
```
====== 1. æ£€æŸ¥åç«¯æœåŠ¡ ======
âœ… åç«¯æ­£å¸¸

====== 2. æ£€æŸ¥å‡­æ®çŠ¶æ€ ======
{
  "LONGPORT_APP_KEY": "xxxxxx",
  "LONGPORT_APP_SECRET": "xxxxxx",
  "LONGPORT_ACCESS_TOKEN": "xxxxxx"
}

====== 3. æ£€æŸ¥æŒä»“æ•°é‡ ======
âœ… æŒä»“è‚¡ç¥¨: 14 åª

====== 4. æ£€æŸ¥Kçº¿æ•°æ® ======
âœ… å·²åŒæ­¥ 14 åªè‚¡ç¥¨çš„Kçº¿æ•°æ®

====== 5. æ£€æŸ¥ç­–ç•¥ä¿¡å· ======
âœ… æŒä»“: 14 | ç›‘æ§: 4 | ä¿¡å·: 8 æ¡
```

---

## æ€»ç»“

**ç­–ç•¥ç›¯ç›˜æ­£å¸¸å·¥ä½œéœ€è¦ï¼š**
1. âœ… æœ‰æ•ˆçš„ ACCESS_TOKEN
2. âœ… æŒä»“è‚¡ç¥¨æˆ–æ‰‹åŠ¨æ·»åŠ çš„è‚¡ç¥¨
3. âœ… å†å²Kçº¿æ•°æ®ï¼ˆè‡³å°‘30æ¡ï¼‰
4. âœ… åç«¯æœåŠ¡è¿è¡Œä¸­

**æœ€å¿«è§£å†³æ–¹æ¡ˆï¼ˆ3æ­¥ï¼‰ï¼š**
1. æ›´æ–° ACCESS_TOKENï¼ˆé€‰æ‹©é•¿æœŸ Tokenï¼‰
2. åœ¨ã€Œå…³äºè¡Œæƒ…ã€é¡µé¢åŒæ­¥å†å²æ•°æ®
3. åˆ·æ–°ã€Œç­–ç•¥ç›¯ç›˜ã€é¡µé¢

---

**é‡åˆ°é—®é¢˜ï¼Ÿ**
- æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š`tail -f /Volumes/SamSung/longbridge/logs/backend.log`
- æŸ¥çœ‹å‰ç«¯æ§åˆ¶å°ï¼šæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
- è¿è¡Œè¯Šæ–­å‘½ä»¤æŸ¥çœ‹è¯¦ç»†çŠ¶æ€

**ç¥ä½ äº¤æ˜“é¡ºåˆ©ï¼** ğŸ“ˆâœ¨




















